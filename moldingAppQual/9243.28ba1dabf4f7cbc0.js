"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9243,4147],{2996:(h,v,n)=>{n.d(v,{W:()=>e});var p=n(2340),c=n(5e3),a=n(6322);let e=(()=>{class r{constructor(i){this.requestService=i}getPrograms(){return this.requestService.createGetRequest(`${p.N.usineApi}programme_avions`)}getIri(i){return"string"==typeof i?i:`/api/programme_avions/${i.id}`}}return r.\u0275fac=function(i){return new(i||r)(c.LFG(a.s))},r.\u0275prov=c.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},9841:(h,v,n)=>{n.d(v,{N:()=>r});var p=n(2340),c=n(5e3),a=n(6322);let r=(()=>{class u{constructor(d){this.requestService=d}getRoles(){return this.requestService.createGetRequest(`${p.N.usineApi}postes`)}getIri(d){return"string"==typeof d?d:`/api/postes/${d.id}`}}return u.\u0275fac=function(d){return new(d||u)(c.LFG(a.s))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},714:(h,v,n)=>{n.d(v,{z:()=>e});var p=n(2340),c=n(5e3),a=n(6322);let e=(()=>{class r{constructor(i){this.requestService=i}getServices(){return this.requestService.createGetRequest(`${p.N.usineApi}services`)}getIri(i){return"string"==typeof i?i:`/api/services/${i.id}`}}return r.\u0275fac=function(i){return new(i||r)(c.LFG(a.s))},r.\u0275prov=c.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},3040:(h,v,n)=>{n.d(v,{W:()=>e});var p=n(2340),c=n(5e3),a=n(6322);let e=(()=>{class r{constructor(i){this.requestService=i}getUnites(){return this.requestService.createGetRequest(`${p.N.usineApi}divisions`)}getIri(i){return"string"==typeof i?i:`/api/services/${i.id}`}}return r.\u0275fac=function(i){return new(i||r)(c.LFG(a.s))},r.\u0275prov=c.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},8:(h,v,n)=>{n.d(v,{f:()=>U});var p=n(655),c=n(2340),a=n(5e3),e=n(6322),r=n(9841),u=n(714),i=n(2996),d=n(3040);let S=(()=>{class o{constructor(){}getIri(t){return"string"==typeof t?t:`/api/services/${t.id}`}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=a.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),U=(()=>{class o{constructor(t,s,l,m,_,f){this.requestService=t,this.roleService=s,this.serviceService=l,this.programService=m,this.uniteService=_,this.usineService=f}getUserById(t){return this.requestService.createGetRequest(c.N.usineApi+`users/${t}`)}getUsers(t){return this.requestService.createGetRequest(`${c.N.usineApi}users`,t)}registerUser(t){return this.requestService.createPostRequest(c.N.usineApi+"users",t)}getIri(t){return"string"==typeof t?t:`/api/users/${t.id}`}getGroups(){return this.requestService.createGetRequest(`${c.N.usineApi}groupe_affectations`)}createGroup(t){return this.requestService.createPostRequest(`${c.N.usineApi}groupe_affectations`,t)}updateUser(t){const s={matricule:t.matricule,nom:t.nom,prenom:t.prenom,poste:this.roleService.getIri(t.poste),service:this.serviceService.getIri(t.service),programmeAvion:t.programmeAvion.map(l=>this.programService.getIri(l)),unite:this.uniteService.getIri(t.unite),site:this.usineService.getIri(t.site),tel:t.tel};return this.requestService.createPatchRequest(`${c.N.usineApi}users/${t.id}`,s)}addUserToGroup(t){return new Promise((s,l)=>(0,p.mG)(this,void 0,void 0,function*(){for(const m of t.groupeAffected){const _={libelle:m.libelle,population:m.population.map(f=>this.getIri(f))};_.population.push(this.getIri(t)),yield this.requestService.createPatchRequest(`${c.N.usineApi}groupe_affectations/${m.id}/addUsers`,{population:_.population}).subscribe(f=>{t.groupeAffected=f})}s(t)}))}getUsersByService(t){return this.requestService.createGetRequest(`${c.N.usineApi}services/${t}`)}deleteUser(t){return this.requestService.createDeleteRequest(`${c.N.usineApi}users/${t}`)}confirmUser(t,s){return this.requestService.createPatchRequest(`${c.N.usineApi}users/${t}`,{isActive:s})}}return o.\u0275fac=function(t){return new(t||o)(a.LFG(e.s),a.LFG(r.N),a.LFG(u.z),a.LFG(i.W),a.LFG(d.W),a.LFG(S))},o.\u0275prov=a.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},2477:(h,v,n)=>{n.d(v,{Q:()=>U});var p=n(655),c=n(2340),a=n(4147),e=n(5e3),r=n(9928),u=n(3919),i=n(4501);let d=(()=>{class o{constructor(t,s,l){this.navCtrl=t,this.authService=s,this.loadingService=l,this.isUserOpen=!1,this.version=a.i8}ngOnInit(){}navigate(t){this.navCtrl.navigateRoot(t)}logoutClick(){this.loadingService.startLoading("D\xe9connexion"),this.authService.logout().subscribe(()=>{this.loadingService.stopLoading(),this.navCtrl.navigateRoot("/login")})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(r.SH),e.Y36(u.e),e.Y36(i.b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user-popover"]],decls:19,vars:1,consts:[["button","","id","trigger-button",3,"click"],["name","settings-outline","slot","start"],["button","",3,"click"],["name","construct-outline","slot","start"],["color","danger",1,"ion-hide-sm-up",3,"click"],["slot","start","name","log-out-outline"]],template:function(t,s){1&t&&(e.TgZ(0,"ion-list")(1,"ion-item",0),e.NdJ("click",function(){return s.isUserOpen=!0}),e.TgZ(2,"ion-label"),e._uU(3,"Profil"),e.qZA()(),e.TgZ(4,"ion-item")(5,"ion-label"),e._uU(6,"Pr\xe9f\xe9rences"),e.qZA(),e._UZ(7,"ion-icon",1),e.qZA(),e.TgZ(8,"ion-item",2),e.NdJ("click",function(){return s.navigate("admin")}),e.TgZ(9,"ion-label"),e._uU(10,"Administration"),e.qZA(),e._UZ(11,"ion-icon",3),e.qZA(),e.TgZ(12,"ion-item",4),e.NdJ("click",function(){return s.logoutClick()}),e._UZ(13,"ion-icon",5),e.TgZ(14,"ion-label"),e._uU(15,"D\xe9connexion"),e.qZA()(),e.TgZ(16,"ion-item")(17,"ion-label"),e._uU(18),e.qZA()()()),2&t&&(e.xp6(18),e.hij(" Version : ",s.version," "))},dependencies:[r.gu,r.Ie,r.Q$,r.q_]}),o})();var S=n(9808);function P(o,g){1&o&&e._UZ(0,"ion-menu-button",14)}let U=(()=>{class o{constructor(t,s,l,m){this.authService=t,this.loadingService=s,this.navCtrl=l,this.popoverCtrl=m,this.user=this.authService.authUser}ngOnDestroy(){console.log("destroy header")}ngOnInit(){this.envMode=c.N.name}logoutClick(){this.loadingService.startLoading("D\xe9connexion"),this.authService.logout().subscribe(()=>{this.loadingService.stopLoading(),this.navCtrl.navigateRoot("/login")})}triggerUserPopover(t){return(0,p.mG)(this,void 0,void 0,function*(){t.preventDefault(),(yield this.popoverCtrl.create({component:d,reference:"trigger",showBackdrop:!0,backdropDismiss:!0,animated:!0,dismissOnSelect:!0})).present()})}navigate(t){this.navCtrl.navigateRoot(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.e),e.Y36(i.b),e.Y36(r.SH),e.Y36(r.Dh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-shared-user-header"]],inputs:{title:"title",hideMenuIcon:"hideMenuIcon"},decls:18,vars:5,consts:[[3,"translucent"],["color","primary"],["slot","start"],["autoHide","false","color","light",4,"ngIf"],["src","assets/images/logoDaherFondBleu.png",1,"ion-hide-sm-down","logo",3,"click"],[1,"ion-text-uppercase","ion-text-center"],["slot","end",1,"dev","ion-hide-sm-down"],["color","light","slot","end","outline","",1,"ion-margin-end",3,"contextmenu"],["buttonProfil",""],["name","person-circle-outline"],["color","light"],["slot","end","color","danger",1,"ion-hide-sm-down","margin",3,"click"],["slot","end","name","log-out-outline"],[1,"ion-hide-md-down"],["autoHide","false","color","light"]],template:function(t,s){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e.YNc(3,P,1,0,"ion-menu-button",3),e.TgZ(4,"ion-img",4),e.NdJ("click",function(){return s.navigate("home")}),e.qZA()(),e.TgZ(5,"ion-title",5),e._uU(6),e.qZA(),e.TgZ(7,"ion-label",6),e._uU(8),e.qZA(),e.TgZ(9,"ion-chip",7,8),e.NdJ("contextmenu",function(m){return s.triggerUserPopover(m)}),e._UZ(11,"ion-icon",9),e.TgZ(12,"ion-label",10),e._uU(13),e.qZA()(),e.TgZ(14,"ion-button",11),e.NdJ("click",function(){return s.logoutClick()}),e._UZ(15,"ion-icon",12),e.TgZ(16,"ion-label",13),e._uU(17,"D\xe9connexion"),e.qZA()()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(3),e.Q6J("ngIf",!s.hideMenuIcon),e.xp6(3),e.Oqu(s.title),e.xp6(2),e.Oqu(s.envMode),e.xp6(5),e.Oqu(null==s.user?null:s.user.username))},dependencies:[S.O5,r.YG,r.Sm,r.hM,r.Gu,r.gu,r.Xz,r.Q$,r.fG,r.sr,r.wd],styles:[".margin[_ngcontent-%COMP%]{margin-right:10px}.logo[_ngcontent-%COMP%]{width:100px}@media print{[_nghost-%COMP%]{display:none}}.dev[_ngcontent-%COMP%]{color:red;text-transform:uppercase;font-size:large;font-weight:700;padding-right:100px}"]}),o})()},4147:h=>{h.exports={i8:"1.5.8"}}}]);