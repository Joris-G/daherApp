"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9243,9540],{4501:(h,v,n)=>{n.d(v,{b:()=>e});var d=n(655),o=n(5e3),a=n(9928);let e=(()=>{class r{constructor(i){this.loadingController=i}startLoading(i="Chargement ..."){this.loadingController.create({spinner:"lines",cssClass:"app-loader",message:i}).then(g=>{g.present()})}stopLoading(){return(0,d.mG)(this,void 0,void 0,function*(){setTimeout(()=>{this.loadingController.dismiss()},100)})}}return r.\u0275fac=function(i){return new(i||r)(o.LFG(a.HT))},r.\u0275prov=o.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},2996:(h,v,n)=>{n.d(v,{W:()=>e});var d=n(2340),o=n(5e3),a=n(6322);let e=(()=>{class r{constructor(i){this.requestService=i}getPrograms(){return this.requestService.createGetRequest(`${d.N.usineApi}programme_avions`)}getIri(i){return"string"==typeof i?i:`/api/programme_avions/${i.id}`}}return r.\u0275fac=function(i){return new(i||r)(o.LFG(a.s))},r.\u0275prov=o.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},9841:(h,v,n)=>{n.d(v,{N:()=>r});var d=n(2340),o=n(5e3),a=n(6322);let r=(()=>{class u{constructor(g){this.requestService=g}getRoles(){return this.requestService.createGetRequest(`${d.N.usineApi}postes`)}getIri(g){return"string"==typeof g?g:`/api/postes/${g.id}`}}return u.\u0275fac=function(g){return new(g||u)(o.LFG(a.s))},u.\u0275prov=o.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},714:(h,v,n)=>{n.d(v,{z:()=>e});var d=n(2340),o=n(5e3),a=n(6322);let e=(()=>{class r{constructor(i){this.requestService=i}getServices(){return this.requestService.createGetRequest(`${d.N.usineApi}services`)}getIri(i){return"string"==typeof i?i:`/api/services/${i.id}`}}return r.\u0275fac=function(i){return new(i||r)(o.LFG(a.s))},r.\u0275prov=o.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},3040:(h,v,n)=>{n.d(v,{W:()=>e});var d=n(2340),o=n(5e3),a=n(6322);let e=(()=>{class r{constructor(i){this.requestService=i}getUnites(){return this.requestService.createGetRequest(`${d.N.usineApi}divisions`)}getIri(i){return"string"==typeof i?i:`/api/services/${i.id}`}}return r.\u0275fac=function(i){return new(i||r)(o.LFG(a.s))},r.\u0275prov=o.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},8:(h,v,n)=>{n.d(v,{f:()=>U});var d=n(655),o=n(2340),a=n(5e3),e=n(6322),r=n(9841),u=n(714),i=n(2996),g=n(3040);let S=(()=>{class s{constructor(){}getIri(t){return"string"==typeof t?t:`/api/services/${t.id}`}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=a.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),U=(()=>{class s{constructor(t,c,l,m,f,_){this.requestService=t,this.roleService=c,this.serviceService=l,this.programService=m,this.uniteService=f,this.usineService=_}getUserById(t){return this.requestService.createGetRequest(o.N.usineApi+`users/${t}`)}getUsers(t){return this.requestService.createGetRequest(`${o.N.usineApi}users`,t)}registerUser(t){return this.requestService.createPostRequest(o.N.usineApi+"users",t)}getIri(t){return"string"==typeof t?t:`/api/users/${t.id}`}getGroups(){return this.requestService.createGetRequest(`${o.N.usineApi}groupe_affectations`)}createGroup(t){return this.requestService.createPostRequest(`${o.N.usineApi}groupe_affectations`,t)}updateUser(t){const c={matricule:t.matricule,nom:t.nom,prenom:t.prenom,poste:this.roleService.getIri(t.poste),service:this.serviceService.getIri(t.service),programmeAvion:t.programmeAvion.map(l=>this.programService.getIri(l)),unite:this.uniteService.getIri(t.unite),site:this.usineService.getIri(t.site),tel:t.tel};return this.requestService.createPatchRequest(`${o.N.usineApi}users/${t.id}`,c)}addUserToGroup(t){return new Promise((c,l)=>(0,d.mG)(this,void 0,void 0,function*(){for(const m of t.groupeAffected){const f={libelle:m.libelle,population:m.population.map(_=>this.getIri(_))};f.population.push(this.getIri(t)),yield this.requestService.createPatchRequest(`${o.N.usineApi}groupe_affectations/${m.id}/addUsers`,{population:f.population}).subscribe(_=>{t.groupeAffected=_})}c(t)}))}getUsersByService(t){return this.requestService.createGetRequest(`${o.N.usineApi}services/${t}`)}deleteUser(t){return this.requestService.createDeleteRequest(`${o.N.usineApi}users/${t}`)}confirmUser(t,c){return this.requestService.createPatchRequest(`${o.N.usineApi}users/${t}`,{isActive:c})}}return s.\u0275fac=function(t){return new(t||s)(a.LFG(e.s),a.LFG(r.N),a.LFG(u.z),a.LFG(i.W),a.LFG(g.W),a.LFG(S))},s.\u0275prov=a.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},2477:(h,v,n)=>{n.d(v,{Q:()=>U});var d=n(655),o=n(2340),a=n(4147),e=n(5e3),r=n(9928),u=n(3919),i=n(4501);let g=(()=>{class s{constructor(t,c,l){this.navCtrl=t,this.authService=c,this.loadingService=l,this.isUserOpen=!1,this.version=a.i8}ngOnInit(){}navigate(t){this.navCtrl.navigateRoot(t)}logoutClick(){this.loadingService.startLoading("D\xe9connexion"),this.authService.logout().subscribe(()=>{this.loadingService.stopLoading(),this.navCtrl.navigateRoot("/login")})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(r.SH),e.Y36(u.e),e.Y36(i.b))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-user-popover"]],decls:19,vars:1,consts:[["button","","id","trigger-button",3,"click"],["name","settings-outline","slot","start"],["button","",3,"click"],["name","construct-outline","slot","start"],["color","danger",1,"ion-hide-sm-up",3,"click"],["slot","start","name","log-out-outline"]],template:function(t,c){1&t&&(e.TgZ(0,"ion-list")(1,"ion-item",0),e.NdJ("click",function(){return c.isUserOpen=!0}),e.TgZ(2,"ion-label"),e._uU(3,"Profil"),e.qZA()(),e.TgZ(4,"ion-item")(5,"ion-label"),e._uU(6,"Pr\xe9f\xe9rences"),e.qZA(),e._UZ(7,"ion-icon",1),e.qZA(),e.TgZ(8,"ion-item",2),e.NdJ("click",function(){return c.navigate("admin")}),e.TgZ(9,"ion-label"),e._uU(10,"Administration"),e.qZA(),e._UZ(11,"ion-icon",3),e.qZA(),e.TgZ(12,"ion-item",4),e.NdJ("click",function(){return c.logoutClick()}),e._UZ(13,"ion-icon",5),e.TgZ(14,"ion-label"),e._uU(15,"D\xe9connexion"),e.qZA()(),e.TgZ(16,"ion-item")(17,"ion-label"),e._uU(18),e.qZA()()()),2&t&&(e.xp6(18),e.hij(" Version : ",c.version," "))},dependencies:[r.gu,r.Ie,r.Q$,r.q_]}),s})();var S=n(9808);function P(s,p){1&s&&e._UZ(0,"ion-menu-button",14)}let U=(()=>{class s{constructor(t,c,l,m){this.authService=t,this.loadingService=c,this.navCtrl=l,this.popoverCtrl=m,this.user=this.authService.authUser}ngOnDestroy(){console.log("destroy header")}ngOnInit(){this.envMode=o.N.name}logoutClick(){this.loadingService.startLoading("D\xe9connexion"),this.authService.logout().subscribe(()=>{this.loadingService.stopLoading(),this.navCtrl.navigateRoot("/login")})}triggerUserPopover(t){return(0,d.mG)(this,void 0,void 0,function*(){t.preventDefault(),(yield this.popoverCtrl.create({component:g,reference:"trigger",showBackdrop:!0,backdropDismiss:!0,animated:!0,dismissOnSelect:!0})).present()})}navigate(t){this.navCtrl.navigateRoot(t)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(u.e),e.Y36(i.b),e.Y36(r.SH),e.Y36(r.Dh))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-shared-user-header"]],inputs:{title:"title",hideMenuIcon:"hideMenuIcon"},decls:18,vars:5,consts:[[3,"translucent"],["color","primary"],["slot","start"],["autoHide","false","color","light",4,"ngIf"],["src","assets/images/logoDaherFondBleu.png",1,"ion-hide-sm-down","logo",3,"click"],[1,"ion-text-uppercase","ion-text-center"],["slot","end",1,"dev","ion-hide-sm-down"],["color","light","slot","end","outline","",1,"ion-margin-end",3,"contextmenu"],["buttonProfil",""],["name","person-circle-outline"],["color","light"],["slot","end","color","danger",1,"ion-hide-sm-down","margin",3,"click"],["slot","end","name","log-out-outline"],[1,"ion-hide-md-down"],["autoHide","false","color","light"]],template:function(t,c){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e.YNc(3,P,1,0,"ion-menu-button",3),e.TgZ(4,"ion-img",4),e.NdJ("click",function(){return c.navigate("home")}),e.qZA()(),e.TgZ(5,"ion-title",5),e._uU(6),e.qZA(),e.TgZ(7,"ion-label",6),e._uU(8),e.qZA(),e.TgZ(9,"ion-chip",7,8),e.NdJ("contextmenu",function(m){return c.triggerUserPopover(m)}),e._UZ(11,"ion-icon",9),e.TgZ(12,"ion-label",10),e._uU(13),e.qZA()(),e.TgZ(14,"ion-button",11),e.NdJ("click",function(){return c.logoutClick()}),e._UZ(15,"ion-icon",12),e.TgZ(16,"ion-label",13),e._uU(17,"D\xe9connexion"),e.qZA()()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(3),e.Q6J("ngIf",!c.hideMenuIcon),e.xp6(3),e.Oqu(c.title),e.xp6(2),e.Oqu(c.envMode),e.xp6(5),e.Oqu(null==c.user?null:c.user.username))},dependencies:[S.O5,r.YG,r.Sm,r.hM,r.Gu,r.gu,r.Xz,r.Q$,r.fG,r.sr,r.wd],styles:[".margin[_ngcontent-%COMP%]{margin-right:10px}.logo[_ngcontent-%COMP%]{width:100px}@media print{[_nghost-%COMP%]{display:none}}.dev[_ngcontent-%COMP%]{color:red;text-transform:uppercase;font-size:large;font-weight:700;padding-right:100px}"]}),s})()},4147:h=>{h.exports={i8:"1.5.8"}}}]);