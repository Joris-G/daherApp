import{G as n,Ib as p,J as l,Jb as h,K as a,Rb as s,Ub as m,l as u,ne as c,oe as d,pe as f}from"./chunk-U2GCEKKH.js";var T=(()=>{class i{authStore=a(d);alerteService=a(c);router=a(m);canActivate(e){let t=e.data.expectedRole,o=this.isRole(t);return o||(this.alerteService.simpleAlert("Alerte de l'application","Autorisation","Vous n'avez pas acc\xE8s \xE0 cette page"),this.router.navigate(["home"])),this.authStore.isAuthenticated()&&o&&this.authStore.user().isActive}isRole(e){return this.authStore.user()?e.some(t=>this.authStore.user().roles.includes(t)):!1}static \u0275fac=function(t){return new(t||i)};static \u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var j=(()=>{class i{http;requestService;alertService;constructor(e,t,o){this.http=e,this.requestService=t,this.alertService=o}getToolByInput(e){return new Promise((t,o)=>{switch(e.length){case 7:this.getToolByToolNumber(e).subscribe(r=>{t(r)},r=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xE0 renvoy\xE9 une erreur :",r),o()});break;case 7:break;case 8:e.startsWith("OT")&&this.getToolByToolNumber(e.substring(e.length-5)).subscribe(r=>{t(r)},r=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xE0 renvoy\xE9 une erreur :",r),o()});break;default:this.getToolByIdentification(e).then(r=>{t(r)},r=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xE0 renvoy\xE9 une erreur :",r),o()}).catch(r=>{console.error(r)});break}})}getToolById(e){return this.requestService.createGetRequest(`${s.toolApi}tools/${e}`)}getToolByToolNumber(e){return this.requestService.createGetRequest(`${s.toolApi}tools?sapToolNumber=${e}`).pipe(u(t=>{if(t.length===1)return t[0];if(t.length>1){console.error("Il y a plus d'un outillage correspondant en base de donn\xE9e");return}else{console.error("aucun outillage trouv\xE9");return}}))}getToolByIdentification(e){return new Promise((t,o)=>{this.requestService.createGetRequest(`${s.toolApi}tools?identification=${e}`).subscribe(r=>{if(r.length===1){let g=r[0];t(g)}else r.length>1?o("Il y a plus d'un outillage correspondant en base de donn\xE9e"):o("aucun outillage trouv\xE9")},r=>{console.log(r),o("Pas de r\xE9ponse du serveur")})})}getAllTools(){return new Promise((e,t)=>{let o=new p().append("content-type","application/json");this.http.get(`${s.apiServer}molding_tools`,{headers:o}).subscribe(r=>{e(r)},r=>{console.log(r),t()})})}getIri(e){return`/api/tools/${e.id}`}createTool(e){let t=e;return t.sapToolNumber=parseInt(e.sapToolNumber.substring(2),10),this.http.post("api/tools",t)}static \u0275fac=function(t){return new(t||i)(l(h),l(f),l(c))};static \u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();export{T as a,j as b};
