"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6824,6188],{4655:(p,m,n)=>{n.d(m,{W:()=>h});var u=n(8260),s=n(3668),a=n(3521);let h=(()=>{class r{constructor(o){this.requestService=o}getPrograms(){return this.requestService.createGetRequest(u.N.usineApi+"programme_avions")}getIri(o){return"string"==typeof o?o:`/api/programme_avions/${o.id}`}}return r.\u0275fac=function(o){return new(o||r)(s.LFG(a.s))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},3580:(p,m,n)=>{n.d(m,{C:()=>S});var u=n(4762),s=n(8260),a=n(3668),h=n(3521),r=n(6188),g=n(7914),o=n(6607);let S=(()=>{class c{constructor(e,i,t,v){this.requestService=e,this.toolService=i,this.userService=t,this.authService=v}getType(e){return"string"==typeof e?e:e.controle?"controle":e.maintenance?"maintenance":void 0}createToolRequest(e){return this.requestService.createPostRequest(s.N.toolApi+"demandes",e)}createControlRequest(e){var i;const t={id:null!==(i=e.id)&&void 0!==i?i:null,outillage:e.outillage?this.toolService.getIri(e.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(this.authService.authUser),refPlan:e.refPlan,indPlan:e.indPlan,cheminCAO:e.cheminCAO,description:e.description,detailsControle:e.detailsControle,tolerances:e.tolerances,dispoOut:e.dispoOut,ligneBudgetaire:e.ligneBudgetaire,typeRapport:e.typeRapport};return this.requestService.createPostRequest(s.N.toolApi+"controles",t)}createAllMaintenaceItems(e){const i=[];return new Promise((t,v)=>{e.itemActionCorrective.forEach(l=>{this.requestService.createPostRequest(s.N.toolApi+"maintenance_items",l).then(P=>{i.push(`/api/maintenance_items/${P.id}`),console.log(i.length,e.itemActionCorrective.length),i.length===e.itemActionCorrective.length&&t(i)})})})}createMaintenanceRequest(e){return new Promise((i,t)=>{this.createAllMaintenaceItems(e).then(v=>{var l;console.log(v);const P={id:null!==(l=e.id)&&void 0!==l?l:null,outillage:e.outillage?this.toolService.getIri(e.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(this.authService.authUser),rep:e.rep,itemActionCorrective:v};console.log(P),this.requestService.createPostRequest(s.N.toolApi+"maintenances",P).then(_=>{i(_)})})})}updateRequest(e){const i={statut:e.statut,createdAt:e.createdAt,id:e.id};return this.requestService.createPutRequest(s.N.toolApi+"demandes/"+i.id,i)}updateControlRequest(e){var i;const t={id:null!==(i=e.controle.id)&&void 0!==i?i:null,outillage:e.controle.outillage?this.toolService.getIri(e.controle.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(e.controle.demandeur),refPlan:e.controle.refPlan,indPlan:e.controle.indPlan,cheminCAO:e.controle.cheminCAO,description:e.controle.description,detailsControle:e.controle.detailsControle,tolerances:e.controle.tolerances,dispoOut:e.controle.dispoOut,ligneBudgetaire:e.controle.ligneBudgetaire,interventionDate:e.controle.interventionDate,moyenMesure:e.controle.moyenMesure,infosComplementaire:e.controle.infosComplementaire,visaControleur:e.controle.visaControleur,typeRapport:e.controle.typeRapport};return console.log(t),this.requestService.createPutRequest(s.N.toolApi+"controles/"+t.id,t)}updateMaintenanceItems(e){return(0,u.mG)(this,void 0,void 0,function*(){const i=e.map(t=>t.id?this.requestService.createPutRequest(s.N.toolApi+"maintenance_items/"+t.id,t):this.requestService.createPostRequest(s.N.toolApi+"maintenance_items",t));return Promise.all(i)})}updateMainteanceRequest(e){return new Promise((i,t)=>{this.updateMaintenanceItems(e.maintenance.itemActionCorrective).then(v=>{var l;e.maintenance.itemActionCorrective=v,console.log(e.maintenance.itemActionCorrective);const P=e.maintenance.itemActionCorrective.map(f=>"/api/maintenance_items/"+f.id),_={id:null!==(l=e.maintenance.id)&&void 0!==l?l:null,outillage:e.maintenance.outillage?this.toolService.getIri(e.maintenance.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(e.maintenance.userCreat),itemActionCorrective:P};console.log(_),i(this.requestService.createPutRequest(s.N.toolApi+"maintenances/"+_.id,_))})})}getToolRequest(e){return this.requestService.createGetRequest(s.N.toolApi+"demandes/"+e)}getToolRequests(){return this.requestService.createGetRequest(s.N.toolApi+"demandes")}getControl(e){return this.requestService.createGetRequest(s.N.toolApi+"controles/"+e)}getMaintenance(e){return this.requestService.createGetRequest(s.N.toolApi+"maintenances/"+e)}removeRequest(e){return new Promise((i,t)=>{this.requestService.createDeleteRequest("demandes/"+e.id)})}}return c.\u0275fac=function(e){return new(e||c)(a.LFG(h.s),a.LFG(r.o),a.LFG(g.f),a.LFG(o.e))},c.\u0275prov=a.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},6188:(p,m,n)=>{n.d(m,{o:()=>g});var u=n(4522),s=n(8260),a=n(3668),h=n(3521),r=n(5243);let g=(()=>{class o{constructor(c,d,e){this.http=c,this.requestService=d,this.alertService=e}getToolByInput(c){return new Promise((d,e)=>{switch(c.length){case 5:this.getToolByToolNumber(c).then(i=>{d(i)},i=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",i),e()}).catch(i=>{console.error(i)});break;case 7:break;case 8:c.startsWith("OT")&&this.getToolByToolNumber(c.substring(c.length-5)).then(i=>{d(i)},i=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",i),e()}).catch(i=>{console.error(i)});break;default:this.getToolByIdentification(c).then(i=>{d(i)},i=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",i),e()}).catch(i=>{console.error(i)})}})}getToolById(c){return this.requestService.createGetRequest(`${s.N.toolApi}tools/${c}`)}getToolByToolNumber(c){return new Promise((d,e)=>{this.requestService.createGetRequest(`${s.N.toolApi}tools?sapToolNumber=${c}`).then(i=>{1===i.length?d(i[0]):e(i.length>1?"Il y a plus d'un outillage correspondant en base de donn\xe9e":"aucun outillage trouv\xe9")},i=>{console.log(i),e("Pas de r\xe9ponse du serveur")})})}getToolByIdentification(c){return new Promise((d,e)=>{this.requestService.createGetRequest(`${s.N.toolApi}tools?identification=${c}`).then(i=>{1===i.length?d(i[0]):e(i.length>1?"Il y a plus d'un outillage correspondant en base de donn\xe9e":"aucun outillage trouv\xe9")},i=>{console.log(i),e("Pas de r\xe9ponse du serveur")})})}getAllTools(){return new Promise((c,d)=>{const e=(new u.WM).append("content-type","application/json");this.http.get(`${s.N.apiServer}molding_tools`,{headers:e}).subscribe(i=>{c(i)},i=>{console.log(i),d()})})}getIri(c){return`/api/tools/${c.id}`}createTool(c){const d=c;return d.sapToolNumber=parseInt(c.sapToolNumber.substring(2),10),this.requestService.createPostRequest(s.N.toolApi+"tools",d)}}return o.\u0275fac=function(c){return new(c||o)(a.LFG(u.eN),a.LFG(h.s),a.LFG(r.c))},o.\u0275prov=a.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},9104:(p,m,n)=>{n.d(m,{N:()=>r});var u=n(8260),s=n(3668),a=n(3521);let r=(()=>{class g{constructor(S){this.requestService=S}getRoles(){return this.requestService.createGetRequest(u.N.usineApi+"postes")}getIri(S){return"string"==typeof S?S:`/api/postes/${S.id}`}}return g.\u0275fac=function(S){return new(S||g)(s.LFG(a.s))},g.\u0275prov=s.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},4552:(p,m,n)=>{n.d(m,{z:()=>h});var u=n(8260),s=n(3668),a=n(3521);let h=(()=>{class r{constructor(o){this.requestService=o}getServices(){return this.requestService.createGetRequest(u.N.usineApi+"services")}getIri(o){return"string"==typeof o?o:`/api/services/${o.id}`}}return r.\u0275fac=function(o){return new(o||r)(s.LFG(a.s))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},2236:(p,m,n)=>{n.d(m,{W:()=>h});var u=n(8260),s=n(3668),a=n(3521);let h=(()=>{class r{constructor(o){this.requestService=o}getUnites(){return this.requestService.createGetRequest(u.N.usineApi+"divisions")}getIri(o){return"string"==typeof o?o:`/api/services/${o.id}`}}return r.\u0275fac=function(o){return new(o||r)(s.LFG(a.s))},r.\u0275prov=s.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},7914:(p,m,n)=>{n.d(m,{f:()=>d});var u=n(8260),s=n(3668),a=n(3521),h=n(9104),r=n(4552),g=n(4655),o=n(2236);let S=(()=>{class e{constructor(){}getIri(t){return"string"==typeof t?t:`/api/services/${t.id}`}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),d=(()=>{class e{constructor(t,v,l,P,_,f){this.requestService=t,this.roleService=v,this.serviceService=l,this.programService=P,this.uniteService=_,this.usineService=f}getUserById(t){return this.requestService.createGetRequest(u.N.usineApi+`users/${t}`)}getUsers(t){return this.requestService.createGetRequest(u.N.usineApi+"users")}registerUser(t){return this.requestService.createPostRequest(u.N.usineApi+"users",t)}getIri(t){return"string"==typeof t?t:`/api/users/${t.id}`}getGroups(){return this.requestService.createGetRequest(u.N.usineApi+"groupe_affectations")}createGroup(t){return this.requestService.createPostRequest(u.N.usineApi+"groupe_affectations",t)}updateUser(t){const v={matricule:t.matricule,nom:t.nom,prenom:t.prenom,poste:this.roleService.getIri(t.poste),service:this.serviceService.getIri(t.service),programmeAvion:t.programmeAvion.map(l=>this.programService.getIri(l)),unite:this.uniteService.getIri(t.unite),site:this.usineService.getIri(t.site)};return this.requestService.createPutRequest(u.N.usineApi+`users/${t.id}`,v)}addUserToGroup(t,v){for(const l of v)this.requestService.createPatchRequest(u.N.usineApi+"groupe_affectations/"+l.id+"/addUsers",[this.getIri(t)])}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(a.s),s.LFG(h.N),s.LFG(r.z),s.LFG(g.W),s.LFG(o.W),s.LFG(S))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},6824:(p,m,n)=>{n.r(m),n.d(m,{ToolListPageModule:()=>i});var u=n(6019),s=n(9133),a=n(1704),h=n(4382),r=n(3668),g=n(3580),o=n(5243);function S(t,v){1&t&&(r.TgZ(0,"ion-row",4),r.TgZ(1,"ion-col",2),r._uU(2,"Test"),r.qZA(),r.TgZ(3,"ion-col",2),r._uU(4,"Test"),r.qZA(),r.qZA())}const d=[{path:"",component:(()=>{class t{constructor(l,P){this.toolRequestService=l,this.alertControleService=P}ngOnInit(){this.updateToolList()}updateToolList(){this.toolRequestService.getToolRequests().then(l=>{this.requestList=l}).catch(l=>{this.alertControleService.simpleAlert("Erreur","Mise \xe0 jour de la liste","La liste des requ\xeates ne s'est pas mise \xe0 jour correctement")})}}return t.\u0275fac=function(l){return new(l||t)(r.Y36(g.C),r.Y36(o.c))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-tool-list"]],decls:12,vars:1,consts:[["fixed",""],[1,"header-row"],["size","6"],["class","request-row",4,"ngFor","ngForOf"],[1,"request-row"]],template:function(l,P){1&l&&(r.TgZ(0,"ion-header"),r.TgZ(1,"ion-toolbar"),r.TgZ(2,"ion-title"),r._uU(3,"toolList"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(4,"ion-content"),r.TgZ(5,"ion-grid",0),r.TgZ(6,"ion-row",1),r.TgZ(7,"ion-col",2),r._uU(8,"header test"),r.qZA(),r.TgZ(9,"ion-col",2),r._uU(10,"header test"),r.qZA(),r.qZA(),r.YNc(11,S,5,0,"ion-row",3),r.qZA(),r.qZA()),2&l&&(r.xp6(11),r.Q6J("ngForOf",P.requestList))},directives:[a.Gu,a.sr,a.wd,a.W2,a.jY,a.Nd,a.wI,u.sg],styles:[""]}),t})()}];let e=(()=>{class t{}return t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[h.Bz.forChild(d)],h.Bz]}),t})(),i=(()=>{class t{}return t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[u.ez,s.u5,a.Pc,e]]}),t})()}}]);