"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9110],{6185:(A,S,t)=>{t.d(S,{e:()=>c});var d=t(520),n=t(2340),u=t(5e3),p=t(8219);let c=(()=>{class v{constructor(l){this.requestService=l}getKitById(l){return new Promise((o,_)=>{(new d.WM).set("content-type","application/json"),this.requestService.createGetRequest(n.N.moldingApi+`datas_kits?page=1&idMM=${l}`).then(e=>{if(console.log(e),0!==e.length){const a={id:e[0].id,aCuirAv:e[0].ACuirAv,aDrapAv:e[0].ADrapAv,createdAt:e[0].createdAt,decongel:e[0].Decongel,designationSAP:e[0].DesignationSAP,idMM:e[0].idMM,lotSAP:e[0].LotSAP,peremptionMoins18:e[0].PeremptionMoins18,referenceSAP:e[0].ReferenceSAP,status:e[0].status,tackLife:e[0].TackLife,timeOut:e[0].TimeOut,updateAt:e[0].updateAt};console.log(a),o(a)}else _()},e=>{console.log(e),_()})})}isPerim(l,o){return new Date(l)<new Date(o)}kitIsInKits(l,o){return!(o.length<=0)&&o.every(_=>_.idMM===l.idMM)}getIri(l){return`/api/datas_kits/${l.id}`}}return v.\u0275fac=function(l){return new(l||v)(u.LFG(p.s))},v.\u0275prov=u.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},9110:(A,S,t)=>{t.d(S,{s:()=>l});var d=t(2340),n=t(5e3),u=t(6185),p=t(8871),c=t(1377),v=t(8219),i=t(520);let l=(()=>{class o{constructor(r,e,a,s,h){this.kitService=r,this.toolService=e,this.userService=a,this.requestService=s,this.http=h}saveMolding(r){return this.requestService.createPostRequest(d.N.moldingApi+"moldings",r)}updateMolding(r){return console.log(r),this.requestService.createPutRequest(d.N.moldingApi+"moldings/"+r.id,r)}updateDates(r){r.aCuireAv=null,r.aDraperAv=null,r.kits.forEach(e=>{(e.aCuirAv<r.aCuireAv||!r.aCuireAv)&&(r.aCuireAv=e.aCuirAv,r.matPolym=e),(e.aDrapAv<r.aDraperAv||!r.aDraperAv)&&(r.aDraperAv=e.aDrapAv,r.matDrap=e)})}moldingServerToMoldingObject(r){const e=[];return r.kits.forEach(a=>{let s=null;s={aCuirAv:a.ACuirAv,aDrapAv:a.ADrapAv,createdAt:a.createdAt,decongel:a.Decongel,designationSAP:a.DesignationSAP,id:a.id,idMM:a.idMM,lotSAP:a.LotSAP,peremptionMoins18:a.PeremptionMoins18,referenceSAP:a.ReferenceSAP,status:a.status,tackLife:a.TackLife,timeOut:a.TimeOut},e.push(s)}),r.kits=e,r}getMoldingById(r){return new Promise((e,a)=>{this.requestService.createGetRequest(d.N.moldingApi+"moldings/"+r).then(s=>{const h=[];s.kits.forEach(g=>{let P=null;P={aCuirAv:g.ACuirAv,aDrapAv:g.ADrapAv,createdAt:g.createdAt,decongel:g.Decongel,designationSAP:g.DesignationSAP,id:g.id,idMM:g.idMM,lotSAP:g.LotSAP,peremptionMoins18:g.PeremptionMoins18,referenceSAP:g.ReferenceSAP,status:g.status,tackLife:g.TackLife,timeOut:g.TimeOut},h.push(P)}),s.kits=h,console.log(s),e(s)},s=>{console.log(s),a()})})}getMoldings(){return this.requestService.createGetRequest(d.N.moldingApi+"moldings")}toIri(r){return{id:r.id,kits:r.kits.map(e=>this.kitService.getIri(e)),moldingDay:r.moldingDay,createdBy:this.userService.getIri(r.createdBy),outillage:r.outillage?this.toolService.getIri(r.outillage):null,aCuireAv:r.aCuireAv,aDraperAv:r.aDraperAv,matPolym:this.kitService.getIri(r.matPolym),matDrap:this.kitService.getIri(r.matDrap)}}}return o.\u0275fac=function(r){return new(r||o)(n.LFG(u.e),n.LFG(p.o),n.LFG(c.f),n.LFG(v.s),n.LFG(i.eN))},o.\u0275prov=n.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},8627:(A,S,t)=>{t.d(S,{W:()=>p});var d=t(2340),n=t(5e3),u=t(8219);let p=(()=>{class c{constructor(i){this.requestService=i}getPrograms(){return this.requestService.createGetRequest(d.N.usineApi+"programme_avions")}getIri(i){return"string"==typeof i?i:`/api/programme_avions/${i.id}`}}return c.\u0275fac=function(i){return new(i||c)(n.LFG(u.s))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},8871:(A,S,t)=>{t.d(S,{o:()=>v});var d=t(520),n=t(2340),u=t(5e3),p=t(8219),c=t(2853);let v=(()=>{class i{constructor(o,_,r){this.http=o,this.requestService=_,this.alertService=r}getToolByInput(o){return new Promise((_,r)=>{switch(o.length){case 5:this.getToolByToolNumber(o).then(e=>{_(e)},e=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",e),r()}).catch(e=>{console.error(e)});break;case 7:break;case 8:o.startsWith("OT")&&this.getToolByToolNumber(o.substring(o.length-5)).then(e=>{_(e)},e=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",e),r()}).catch(e=>{console.error(e)});break;default:this.getToolByIdentification(o).then(e=>{_(e)},e=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",e),r()}).catch(e=>{console.error(e)})}})}getToolById(o){return this.requestService.createGetRequest(`${n.N.toolApi}tools/${o}`)}getToolByToolNumber(o){return new Promise((_,r)=>{this.requestService.createGetRequest(`${n.N.toolApi}tools?sapToolNumber=${o}`).then(e=>{1===e.length?_(e[0]):r(e.length>1?"Il y a plus d'un outillage correspondant en base de donn\xe9e":"aucun outillage trouv\xe9")},e=>{console.log(e),r("Pas de r\xe9ponse du serveur")})})}getToolByIdentification(o){return new Promise((_,r)=>{this.requestService.createGetRequest(`${n.N.toolApi}tools?identification=${o}`).then(e=>{1===e.length?_(e[0]):r(e.length>1?"Il y a plus d'un outillage correspondant en base de donn\xe9e":"aucun outillage trouv\xe9")},e=>{console.log(e),r("Pas de r\xe9ponse du serveur")})})}getAllTools(){return new Promise((o,_)=>{const r=(new d.WM).append("content-type","application/json");this.http.get(`${n.N.apiServer}molding_tools`,{headers:r}).subscribe(e=>{o(e)},e=>{console.log(e),_()})})}getIri(o){return`/api/tools/${o.id}`}createTool(o){const _=o;return _.sapToolNumber=parseInt(o.sapToolNumber.substring(2),10),this.requestService.createPostRequest(n.N.toolApi+"tools",_)}}return i.\u0275fac=function(o){return new(o||i)(u.LFG(d.eN),u.LFG(p.s),u.LFG(c.c))},i.\u0275prov=u.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},181:(A,S,t)=>{t.d(S,{N:()=>c});var d=t(2340),n=t(5e3),u=t(8219);let c=(()=>{class v{constructor(l){this.requestService=l}getRoles(){return this.requestService.createGetRequest(d.N.usineApi+"postes")}getIri(l){return"string"==typeof l?l:`/api/postes/${l.id}`}}return v.\u0275fac=function(l){return new(l||v)(n.LFG(u.s))},v.\u0275prov=n.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},4337:(A,S,t)=>{t.d(S,{z:()=>p});var d=t(2340),n=t(5e3),u=t(8219);let p=(()=>{class c{constructor(i){this.requestService=i}getServices(){return this.requestService.createGetRequest(d.N.usineApi+"services")}getIri(i){return"string"==typeof i?i:`/api/services/${i.id}`}}return c.\u0275fac=function(i){return new(i||c)(n.LFG(u.s))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},7847:(A,S,t)=>{t.d(S,{W:()=>p});var d=t(2340),n=t(5e3),u=t(8219);let p=(()=>{class c{constructor(i){this.requestService=i}getUnites(){return this.requestService.createGetRequest(d.N.usineApi+"divisions")}getIri(i){return"string"==typeof i?i:`/api/services/${i.id}`}}return c.\u0275fac=function(i){return new(i||c)(n.LFG(u.s))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},1377:(A,S,t)=>{t.d(S,{f:()=>r});var d=t(655),n=t(2340),u=t(5e3),p=t(8219),c=t(181),v=t(4337),i=t(8627),l=t(7847);let o=(()=>{class e{constructor(){}getIri(s){return"string"==typeof s?s:`/api/services/${s.id}`}}return e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),r=(()=>{class e{constructor(s,h,g,P,E,f){this.requestService=s,this.roleService=h,this.serviceService=g,this.programService=P,this.uniteService=E,this.usineService=f}getUserById(s){return this.requestService.createGetRequest(n.N.usineApi+`users/${s}`)}getUsers(s){return this.requestService.createGetRequest(n.N.usineApi+"users")}registerUser(s){return this.requestService.createPostRequest(n.N.usineApi+"users",s)}getIri(s){return"string"==typeof s?s:`/api/users/${s.id}`}getGroups(){return this.requestService.createGetRequest(n.N.usineApi+"groupe_affectations")}createGroup(s){return this.requestService.createPostRequest(n.N.usineApi+"groupe_affectations",s)}updateUser(s){const h={matricule:s.matricule,nom:s.nom,prenom:s.prenom,poste:this.roleService.getIri(s.poste),service:this.serviceService.getIri(s.service),programmeAvion:s.programmeAvion.map(g=>this.programService.getIri(g)),unite:this.uniteService.getIri(s.unite),site:this.usineService.getIri(s.site)};return this.requestService.createPutRequest(n.N.usineApi+`users/${s.id}`,h)}addUserToGroup(s){return new Promise((h,g)=>(0,d.mG)(this,void 0,void 0,function*(){for(const P of s.groupeAffectations){const E={libelle:P.libelle,population:P.population.map(f=>this.getIri(f))};E.population.push(this.getIri(s)),yield this.requestService.createPatchRequest(n.N.usineApi+"groupe_affectations/"+P.id+"/addUsers",{population:E.population}).then(f=>{s.groupeAffectations=f})}h(s)}))}getUsersByService(s){return this.requestService.createGetRequest(n.N.usineApi+`services/${s}`)}deleteUser(s){return this.requestService.createDeleteRequest(n.N.usineApi+`users/${s}`)}}return e.\u0275fac=function(s){return new(s||e)(u.LFG(p.s),u.LFG(c.N),u.LFG(v.z),u.LFG(i.W),u.LFG(l.W),u.LFG(o))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);